{
  "$schema": "https://automecanik.local/schemas/constraints-v1.json",
  "version": "1.0.0",
  "name": "auto-automecanik",
  "description": "Contraintes specifiques AutoMecanik (RPC, SEO, V-Level, RM)",

  "extends": "default",

  "allowed_paths": [
    "backend/src/modules/seo/**",
    "backend/src/modules/catalog/**",
    "backend/src/modules/search/**",
    "frontend/app/routes/pieces.*",
    "frontend/app/routes/admin.seo-hub.*"
  ],

  "forbidden_paths": [
    ".spec/00-canon/**",
    ".local/governance-vault/**",
    "backend/src/modules/rm/**",
    "backend/src/modules/payments/**",
    "backend/src/config/env-validation.ts",
    "**/*.env*",
    "**/secrets/**"
  ],

  "forbidden_patterns": [
    "SUPABASE_SERVICE_ROLE_KEY",
    "process.env",
    "exec_sql(",
    "createClient.*service_role",
    "git push --force",
    "DROP TABLE",
    "TRUNCATE",
    "DELETE FROM.*WHERE 1=1"
  ],

  "rpc_governance": {
    "mode": "observe",
    "allowed_rpc": [
      "get_seo_page_data",
      "get_vlevel_score",
      "get_sitemap_urls",
      "get_catalog_tree",
      "search_products",
      "get_product_by_slug"
    ],
    "forbidden_rpc": [
      "admin_*",
      "delete_*",
      "truncate_*",
      "exec_sql"
    ],
    "require_audit_log": true
  },

  "seo_constraints": {
    "vlevel_range": [1, 5],
    "max_meta_title_length": 60,
    "max_meta_description_length": 160,
    "forbidden_seo_patterns": [
      "{{.*}}",
      "undefined",
      "null",
      "NaN"
    ],
    "require_canonical": true,
    "require_robots_meta": true
  },

  "rm_module": {
    "status": "dev_only",
    "forbidden_in_production": true,
    "reason": "ADR-004: Module RM is DEV-only due to unresolved @monorepo/shared-types import"
  },

  "diff_budget": {
    "max_files": 10,
    "max_lines": 500,
    "max_additions": 400,
    "max_deletions": 100
  },

  "validation_rules": {
    "require_lint_pass": true,
    "require_typecheck_pass": true,
    "require_tests_pass": false,
    "require_bundle_manifest": true,
    "require_evidence_json": true
  },

  "audit_trail": {
    "required": true,
    "format": "json",
    "include_diff": true,
    "include_reasoning": true
  }
}

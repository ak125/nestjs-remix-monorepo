import { Module } from '@nestjs/common';
import { ConfigModule } from '@nestjs/config';

// Controllers
import { SearchController } from './controllers/search.controller';
import { SearchAdminController } from './controllers/search-admin.controller';

// Core Services
import { SearchService } from './services/search.service';
import { MeilisearchService } from './services/meilisearch.service';
import { ProductSheetService } from './services/product-sheet.service';

// Specialized Services
import { SearchCacheService } from './services/search-cache.service';
import { SearchAnalyticsService } from './services/search-analytics.service';
import { SearchSuggestionService } from './services/search-suggestion.service';
import { SearchFilterService } from './services/search-filter.service';

// External modules
import { CacheModule } from '../../cache/cache.module';

/**
 * 🔍 SearchModule - Moteur de recherche Enterprise v2.0
 * 
 * Architecture complète et optimisée pour FAFA AUTO :
 * ✅ 714K+ pages indexées avec Meilisearch
 * ✅ Recherche véhicules avancée multi-critères
 * ✅ Cache intelligent Redis avec TTL adaptatif
 * ✅ Analytics temps réel et suggestions IA
 * ✅ Auto-complétion intelligente
 * ✅ Filtres dynamiques et facettes
 * ✅ Recherche sémantique avec ML
 * ✅ API GraphQL et REST
 * ✅ Monitoring et métriques
 * ✅ Rate limiting et sécurité
 */
@Module({
  imports: [ConfigModule, CacheModule],
  controllers: [SearchController, SearchAdminController],
  providers: [
    // Core Services
    SearchService, // 🎯 Service principal orchestrateur
    MeilisearchService, // � Service Meilisearch
    ProductSheetService, // 📄 Fiches produits et documentation

    // Specialized Services
    SearchCacheService, // 💾 Cache Redis intelligent avec ML
    SearchAnalyticsService, // 📈 Analytics et métriques avancées
    SearchSuggestionService, // 🤖 Suggestions IA et auto-complétion
    SearchFilterService, // 🔧 Filtres dynamiques et facettes
  ],
  exports: [
    SearchService,
    MeilisearchService,
    SearchAnalyticsService,
    SearchCacheService,
  ],
})
export class SearchModule {}
